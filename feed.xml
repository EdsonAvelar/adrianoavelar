<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.6">Jekyll</generator><link href="http://www.adrianoavelar.com/feed.xml" rel="self" type="application/atom+xml" /><link href="http://www.adrianoavelar.com/" rel="alternate" type="text/html" /><updated>2020-08-13T17:10:32-03:00</updated><id>http://www.adrianoavelar.com/feed.xml</id><title type="html">DataBlow</title><subtitle>Um blog para falar de dados</subtitle><entry><title type="html">Aprendizado por Reforço - Introdução</title><link href="http://www.adrianoavelar.com/rf/introducao.html" rel="alternate" type="text/html" title="Aprendizado por Reforço - Introdução " /><published>2019-07-24T00:00:00-03:00</published><updated>2019-07-24T00:00:00-03:00</updated><id>http://www.adrianoavelar.com/rf/reinforcement_learning_post1</id><content type="html" xml:base="http://www.adrianoavelar.com/rf/introducao.html">&lt;h1 id=&quot;introdução-a-aprendizagem-por-reforço&quot;&gt;Introdução a Aprendizagem por Reforço&lt;/h1&gt;

&lt;p&gt;Muitos dos conceitos aqui presentes foram retirados do livro:&lt;code class=&quot;highlighter-rouge&quot;&gt;Hands-On Machine Learning with Scikit-Learn &amp;amp; TensorFlow&lt;/code&gt; - Aurélien Géron&lt;/p&gt;

&lt;p&gt;Aprendizado por Reforço (&lt;em&gt;Reinformecent Learning&lt;/em&gt;) é um dos campos mais excitantes do Aprendizado de Máquina e também um dos mais antigos. Hoje existem diversas aplicações, principalmente em jogos e controles de máquinas (robôs, carros autônomos).&lt;/p&gt;

&lt;p&gt;Na industria o RL ainda é pouco explorado, por dois motivos:&lt;/p&gt;

&lt;h3 id=&quot;1-maturidade&quot;&gt;1) Maturidade&lt;/h3&gt;
&lt;p&gt;Hoje a preocupação maior é em obter, armazenar e tratar os dados. Existe o hype na industria de que as decisões orientadas a dados é importante, porém grande parte das empresas ainda não tem infraestrutura orientadas a dados.&lt;/p&gt;

&lt;h3 id=&quot;2-relevância&quot;&gt;2) Relevância&lt;/h3&gt;
&lt;p&gt;Tem um pouco a ver com a maturidade. As empresas ainda não acham relevante aplicar Aprendizado por Reforço em seus produtos. Em muitas delas a área de Ciência de Dados quase não tem Inteligência, é mais um conjunto de regras e filtros do que inteligẽncia em si.&lt;/p&gt;

&lt;p&gt;Porém, com a maturidade cada vez maior e o aumento da relevãncia da área de dados, novas possibilidades estão surgindo no mercado. Isso permite que a &lt;code class=&quot;highlighter-rouge&quot;&gt;Ciẽncias&lt;/code&gt; (Experimentação) se torne atraente também dentro das empresas.&lt;/p&gt;

&lt;h2 id=&quot;poder-do-aprendizado-por-reforço&quot;&gt;Poder do Aprendizado por Reforço&lt;/h2&gt;
&lt;p&gt;Sem dúvida, o aprendizado por reforço é uma das área mais promissoras. O que separa um simples modelo de uma tarefa complexa é apenas o tempo de treinamento.
Em 2014, uma empresa chamada DeepMind foi comprada pelo google por 500 milhões de dolares. Ela cria tecnologias baseadas em RL para todos os tipos de problemas. Na época ela ficou famosa por demonstrar que um sistema simples era capaz de aprender a jogar um jogo do Atari. Em meados de 2016, uma de suas criações AlphaGo, ganhou o campeão mundial do jogo GO.&lt;/p&gt;

&lt;p&gt;Hoje o google utiliza muitas das tecnologias da DeepMind para melhorar seus próprios produtos. Principalmente utilizando sistemas de recomendação, detecção de SPAM e ofertas personalizadas para cada perfil de usuário.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://www.tecnologiae.com.br/wp-content/uploads/2017/04/aprendizagem-maquina-e1493300647272.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;aprendizado-por-reforço-recompensa&quot;&gt;Aprendizado por ~Reforço~ Recompensa&lt;/h2&gt;

&lt;p&gt;No RL, um &lt;code class=&quot;highlighter-rouge&quot;&gt;Agente&lt;/code&gt; oberva um &lt;code class=&quot;highlighter-rouge&quot;&gt;Ambiente&lt;/code&gt; e executa determinadas &lt;code class=&quot;highlighter-rouge&quot;&gt;Ações&lt;/code&gt; que vão lhe trazer maior &lt;code class=&quot;highlighter-rouge&quot;&gt;Recompensa&lt;/code&gt;. Cada posição do Agente é chamada de &lt;code class=&quot;highlighter-rouge&quot;&gt;estado&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;O objetivo do Agente é aprender um jeito de realizar uma tarefa que dê o maior soma total de recompensas&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Pense na imagem abaixo, o objetivo do Mario é chegar até a princesa.&lt;/p&gt;

&lt;p&gt;O Mário não sabe o percurso até a princesa, então ele precisa achar o caminho por meio de tentativa e erro. Se ele fizer algo de errado, como por exemplo ir para uma casa onde tem um inimigo ele receberá uma &lt;strong&gt;recompensa negativa&lt;/strong&gt;. Caso ele chegue na princesa, ganha uma &lt;strong&gt;recompensa positiva&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;No final, após várias tentativas, o nosso querido mário terá em maos um &lt;strong&gt;MAPA&lt;/strong&gt; com o melhor caminho partindo de qualquer lugar (qualquer estado).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://miro.medium.com/max/2642/1*83qMkjkWaGP7HWfGiImyqw.png&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;policy-search&quot;&gt;Policy Search&lt;/h2&gt;

&lt;p&gt;O termo &lt;em&gt;Policy&lt;/em&gt; é dificil de traduzir. Poderia ser políticas, conjunto de regras ou estratégia. O Fato é que a &lt;em&gt;Policy&lt;/em&gt; é algoritmo usado pelo agente para tomar as decisões.&lt;/p&gt;

&lt;p&gt;Em nosso exemplo do Mário, a &lt;em&gt;Policy&lt;/em&gt; seria o Mapa. Inicialmente o Mapa vem em branco e é preenchido com os &lt;strong&gt;estados&lt;/strong&gt; e as &lt;strong&gt;ações&lt;/strong&gt; do mario durante sua trajetória.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Policy Search&lt;/em&gt; ou (Busca pela Política) é a busca pelas ações que o agente tem que tomar dado que ele está em um determinado estado. Chama-se &lt;code class=&quot;highlighter-rouge&quot;&gt;política ótima&lt;/code&gt; para a política que fornece a maior soma total de recompensas.&lt;/p&gt;

&lt;p&gt;Existem várias formas de buscar uma política ótima ( ou preencher o melhor Mapa do Mario)&lt;/p&gt;

&lt;h3 id=&quot;1-força-bruta&quot;&gt;1) Força Bruta&lt;/h3&gt;
&lt;p&gt;Poderiamos testar para cada posição do mário qual a melhor ação. Em um cenário pequeno isso é simples de fazer. Mas pense em um robô aspirador de pó, o número de estados é muito grande ou até infinito.&lt;/p&gt;

&lt;h3 id=&quot;2-algoritmo-genético&quot;&gt;2) Algoritmo Genético&lt;/h3&gt;
&lt;p&gt;Para ambientes onde o conjutno de estados é muito grande poderia-se utilziar algoritmos genético.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;a) Cria-se aleatoriamente algumas politicas&lt;/li&gt;
  &lt;li&gt;b) Testa as politicas e elimina as piores&lt;/li&gt;
  &lt;li&gt;c) Cria-se novas politicas a apartir da combinação das melhores politicas&lt;/li&gt;
  &lt;li&gt;d) Repete esse processo até achar uma política satisfatória.
É um boa estratégia, mas precisa de poder computacional e o tempo de execução por ser um grande problema.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;3-policy-gradient&quot;&gt;3) Policy Gradient&lt;/h3&gt;
&lt;p&gt;É uma técnica de otimização bastante utilizada. O gradiente utiliza derivadas para achar valores mínimos (Gradiente Descendente) ou valores máximos (Gradiente Ascendente). Quem já conhece as redes neurais já ouviu fazer do Gradiente Descendente. No algoritmo de backprograpação, o gradiente é usado para atualizar os pesos da rede neural através da minimização do erro total. No caso da RL, o objetivo é maximizar a recompensa, por isso, é utilizado o Gradiente Ascendente.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://matheusfacure.github.io/img/tutorial/momento.gif&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ambiente-environment&quot;&gt;Ambiente (Environment)&lt;/h2&gt;

&lt;p&gt;Um dos principais desafios do Reinforcement Learning é o ambiente. Pense em um agente aprendendo a jogar Dota2, famoso jogo de estratégia entre equipes (gif abaixo). O ambiente são todas as arvores, as torres, os inimigos tudo.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://thumbs.gfycat.com/EmbarrassedCharmingLhasaapso-size_restricted.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=tfb6aEUMC04&quot;&gt; OpenAI Vence Campeões Mundiais de Dota 2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Agora, imagine que estamos programando um robozinho virtual para aprender a caminhar usando 2 pernas, como na figura abaixo. O ambiente são as descidas, subidas, obstáculos etc.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://miro.medium.com/max/1192/1*lG_9GxvSBOvfZ1dvdUXu6A.gif&quot; /&gt;&lt;/p&gt;

&lt;p&gt;E se você tiver fazendo um sistema de aprendizado por reforço para dar recomendações de filmes, como acontecer no NetFlix por exemplo?&lt;/p&gt;

&lt;p&gt;O agente seria o modelo e o ambiente seria o conjunto de caracteristicas dos filmes mais informações dos usuário por exemplo.&lt;/p&gt;

&lt;p&gt;O objetivo do modelo seria, para um conjunto de caracteristas de um usuário e dos filmes do catálogo, qual a melhor recomendação para este usuário.&lt;/p&gt;

&lt;h3 id=&quot;pŕoximo-post-vamos-para-o-handson&quot;&gt;Pŕoximo Post Vamos para o HandsOn&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://static.imagemwhats.com.br/content/assetz/uploads/2017/10/gif-do-garoto-menino-dando-joinha.gif&quot; /&gt;&lt;/p&gt;</content><author><name>adriano</name></author><category term="featured" /><summary type="html">Introdução a Aprendizagem por Reforço</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://img.ibxk.com.br/2018/10/15/corpos-15114949494090.gif" /></entry><entry><title type="html">Curso de Spark e Python: Aula 03 - Hello World</title><link href="http://www.adrianoavelar.com/spark/aula03_dataframe2.html" rel="alternate" type="text/html" title="Curso de Spark e Python: Aula 03 - Hello World" /><published>2019-06-26T00:00:00-03:00</published><updated>2019-06-26T00:00:00-03:00</updated><id>http://www.adrianoavelar.com/spark/aula03_dataframe_part2</id><content type="html" xml:base="http://www.adrianoavelar.com/spark/aula03_dataframe2.html">&lt;h1 id=&quot;curso-de-spark-e-python&quot;&gt;Curso de Spark e Python&lt;/h1&gt;
&lt;h2 id=&quot;aula-03---dataframe-ii&quot;&gt;Aula 03 - DataFrame II&lt;/h2&gt;

&lt;p&gt;Seja bem vindo a mais uma aula sobre Spark e Python. Hoje vamos continuar nossos estudos sobre Dataframe Spark.&lt;/p&gt;

&lt;p&gt;Vamos fazer o mesmo da aula passada.&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Primeiro utilizamos o findspark para pegar o pacote pyspark&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;findspark&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;findspark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Importamos o SparkSession e criamos uma Sessão Spark&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HelloWorld&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Criamos nosso Schema para controlar a importação os dados&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;data_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Importamos os dados e criamos um DataFrame&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'uploads/data/people.json'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_schema&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Finalmente imprimimos o Schema para saber se está tudo certo.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;df.printSchema()&lt;/p&gt;

&lt;h2 id=&quot;selecionando-os-dados-select&quot;&gt;Selecionando os dados (select)&lt;/h2&gt;
&lt;p&gt;Vamos analisar os dois comandos abaixo. Ambos tentam pegar a coluna ‘age’, porém o primeiro utiliza um sintaxe semelhante ao &lt;code class=&quot;highlighter-rouge&quot;&gt;pandas&lt;/code&gt; e o segundo utiliza a função select. No primeiro caso o retorno é um objeto Column.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pyspark.sql.column.Column
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O problema é que não é possível manipular um objeto &lt;code class=&quot;highlighter-rouge&quot;&gt;Column&lt;/code&gt;. Ele não foi feito para isso. Veja o comando abaixo.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;---------------------------------------------------------------------------

TypeError                                 Traceback (most recent call last)

&amp;lt;ipython-input-15-176e0fb11baa&amp;gt; in &amp;lt;module&amp;gt;
----&amp;gt; 1 df['age'].show()


TypeError: 'Column' object is not callable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O DataFrame é o objeto ideal para manipulação. Para obter um DataFrame utiliza-se o comando Select.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pyspark.sql.dataframe.DataFrame
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Agora sim é possível obter as informações, pois estamos trabalhando com um DataFrame.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+
| age|
+----+
|null|
|  30|
|  19|
+----+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Para obter as primeiras linhas de um dataframe usa-se o comando &lt;code class=&quot;highlighter-rouge&quot;&gt;head&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#Pega as duas primeiras linhas
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Row(age=None, name='Michael'), Row(age=30, name='Andy')]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Obtendo multiplas colunas&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+
| age|   name|
+----+-------+
|null|Michael|
|  30|   Andy|
|  19| Justin|
+----+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;criando-e-adicionando-novas-colunas-withcolumn&quot;&gt;Criando e Adicionando Novas Colunas (WithColumn)&lt;/h2&gt;

&lt;p&gt;A criação de novas colunas é uma das operações mais comuns no dia dia de quem trabalha com spark. Essa operação é realizada com a função &lt;code class=&quot;highlighter-rouge&quot;&gt;withColumn&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'newage'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+------+
| age|   name|newage|
+----+-------+------+
|null|Michael|  null|
|  30|   Andy|    30|
|  19| Justin|    19|
+----+-------+------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;É possível fazer transformações na coluna criada&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'double_age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+----------+
| age|   name|double_age|
+----+-------+----------+
|null|Michael|      null|
|  30|   Andy|        60|
|  19| Justin|        38|
+----+-------+----------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A nova coluna pode ser uma expressão&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'jovem'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+------+
| age|   name|newage|
+----+-------+------+
|null|Michael|  null|
|  30|   Andy| false|
|  19| Justin|  true|
+----+-------+------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Mas lembre-se, um dataframe é imutável. &lt;code class=&quot;highlighter-rouge&quot;&gt;df.show()&lt;/code&gt; mostrará o mesmo resultado de antes do &lt;code class=&quot;highlighter-rouge&quot;&gt;withColumn&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+
| age|   name|
+----+-------+
|null|Michael|
|  30|   Andy|
|  19| Justin|
+----+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Não é possível acrescentar uma coluna ao dataframe original, mas podemos criar outro dataframe com a coluna adicionada.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'jovem'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+-----+
| age|   name|jovem|
+----+-------+-----+
|null|Michael| null|
|  30|   Andy|false|
|  19| Justin| true|
+----+-------+-----+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Outra operação comum é renomear colunas.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumnRenamed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+
|age2|   name|
+----+-------+
|null|Michael|
|  30|   Andy|
|  19| Justin|
+----+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;usando-sql-puro&quot;&gt;Usando SQL Puro&lt;/h2&gt;

&lt;p&gt;Com Spark Dataframe é possivel realizar operações como se tiveremos trabalhando com banco SQL. &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Primeiramente, vamos transformar nosso dataframe em um TempView.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'people'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vamos criar e executar a Query SQL, guardamos o resultado em &lt;code class=&quot;highlighter-rouge&quot;&gt;results&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;sql_query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM people&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql_query&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Mostramos os resultados e voilá!&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+
| age|   name|
+----+-------+
|null|Michael|
|  30|   Andy|
|  19| Justin|
+----+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Outro exemplo:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;sql_query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM people WHERE age=30&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql_query&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+---+----+
|age|name|
+---+----+
| 30|Andy|
+---+----+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Em nosso curso o foco não será em operações SQL e sim em Python. &lt;br /&gt;
Ficaremos por aqui.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;&amp;quot;/categories.html#curso_spark&amp;quot;&quot;&gt;Aula 04&lt;/a&gt;&lt;/p&gt;</content><author><name>adriano</name></author><category term="featured" /><summary type="html">Curso de Spark e Python Aula 03 - DataFrame II</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.wavy.global/wp-content/uploads/2019/07/shahadat-shemul-BfrQnKBulYQ-unsplash-780x450.jpg" /></entry><entry><title type="html">Curso de Spark e Python: Aula 04 - Operações Básicas</title><link href="http://www.adrianoavelar.com/spark/aula04_basic_operations" rel="alternate" type="text/html" title="Curso de Spark e Python: Aula 04 - Operações Básicas" /><published>2019-06-26T00:00:00-03:00</published><updated>2019-06-26T00:00:00-03:00</updated><id>http://www.adrianoavelar.com/spark/aula04_basic_operations</id><content type="html" xml:base="http://www.adrianoavelar.com/spark/aula04_basic_operations">&lt;h1 id=&quot;curso-de-spark-e-python&quot;&gt;Curso de Spark e Python&lt;/h1&gt;
&lt;h2 id=&quot;aula-04---operações-bàsicas&quot;&gt;Aula 04 - Operações Bàsicas&lt;/h2&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;findspark&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;findspark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Aula04&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vamos baixar o dataset desta aula.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wget&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'http://adrianoavelar.com/uploads/datasets/appl_stock.csv'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--2020-06-26 11:31:52--  http://adrianoavelar.com/uploads/datasets/appl_stock.csv
Resolving adrianoavelar.com (adrianoavelar.com)... 107.180.27.152
Connecting to adrianoavelar.com (adrianoavelar.com)|107.180.27.152|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 143130 (140K) [text/csv]
Saving to: ‘stock.csv’

stock.csv             9%[&amp;gt;                   ]  13,62K  --.-KB/s    eta 4m 42s ^C
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;carregando-os-dados-em-csv-para-dataframe-spark&quot;&gt;Carregando os dados em &lt;code class=&quot;highlighter-rouge&quot;&gt;.csv&lt;/code&gt; para &lt;code class=&quot;highlighter-rouge&quot;&gt;DataFrame Spark&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote&gt;
  &lt;p&gt;Pede para inferir o Schema e informa que o arquivo possui cabeçalho&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'stock.csv'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inferSchema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root
 |-- Date: timestamp (nullable = true)
 |-- Open: double (nullable = true)
 |-- High: double (nullable = true)
 |-- Low: double (nullable = true)
 |-- Close: double (nullable = true)
 |-- Volume: integer (nullable = true)
 |-- Adj Close: double (nullable = true)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vamos dar uma olhada na tabela usando o &lt;code class=&quot;highlighter-rouge&quot;&gt;pandas&lt;/code&gt;.&lt;br /&gt;
Lembre-se que o pandas não é a forma correta de manipular dados distribuidos em Big Data. Mas podemos utilizá-lo para algumas visualizações pequenas.&lt;br /&gt;
Recomendo utilizar o &lt;code class=&quot;highlighter-rouge&quot;&gt;limit&lt;/code&gt; para limitar a tabela antes de usar o &lt;code class=&quot;highlighter-rouge&quot;&gt;pandas&lt;/code&gt;.&lt;br /&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Open&lt;/th&gt;
      &lt;th&gt;High&lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
      &lt;th&gt;Volume&lt;/th&gt;
      &lt;th&gt;Adj Close&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2010-01-04&lt;/td&gt;
      &lt;td&gt;213.429998&lt;/td&gt;
      &lt;td&gt;214.499996&lt;/td&gt;
      &lt;td&gt;212.380001&lt;/td&gt;
      &lt;td&gt;214.009998&lt;/td&gt;
      &lt;td&gt;123432400&lt;/td&gt;
      &lt;td&gt;27.727039&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2010-01-05&lt;/td&gt;
      &lt;td&gt;214.599998&lt;/td&gt;
      &lt;td&gt;215.589994&lt;/td&gt;
      &lt;td&gt;213.249994&lt;/td&gt;
      &lt;td&gt;214.379993&lt;/td&gt;
      &lt;td&gt;150476200&lt;/td&gt;
      &lt;td&gt;27.774976&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2010-01-06&lt;/td&gt;
      &lt;td&gt;214.379993&lt;/td&gt;
      &lt;td&gt;215.230000&lt;/td&gt;
      &lt;td&gt;210.750004&lt;/td&gt;
      &lt;td&gt;210.969995&lt;/td&gt;
      &lt;td&gt;138040000&lt;/td&gt;
      &lt;td&gt;27.333178&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2010-01-07&lt;/td&gt;
      &lt;td&gt;211.750000&lt;/td&gt;
      &lt;td&gt;212.000006&lt;/td&gt;
      &lt;td&gt;209.050005&lt;/td&gt;
      &lt;td&gt;210.580000&lt;/td&gt;
      &lt;td&gt;119282800&lt;/td&gt;
      &lt;td&gt;27.282650&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2010-01-08&lt;/td&gt;
      &lt;td&gt;210.299994&lt;/td&gt;
      &lt;td&gt;212.000006&lt;/td&gt;
      &lt;td&gt;209.060005&lt;/td&gt;
      &lt;td&gt;211.980005&lt;/td&gt;
      &lt;td&gt;111902700&lt;/td&gt;
      &lt;td&gt;27.464034&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;2010-01-11&lt;/td&gt;
      &lt;td&gt;212.799997&lt;/td&gt;
      &lt;td&gt;213.000002&lt;/td&gt;
      &lt;td&gt;208.450005&lt;/td&gt;
      &lt;td&gt;210.110003&lt;/td&gt;
      &lt;td&gt;115557400&lt;/td&gt;
      &lt;td&gt;27.221758&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;2010-01-12&lt;/td&gt;
      &lt;td&gt;209.189995&lt;/td&gt;
      &lt;td&gt;209.769995&lt;/td&gt;
      &lt;td&gt;206.419998&lt;/td&gt;
      &lt;td&gt;207.720001&lt;/td&gt;
      &lt;td&gt;148614900&lt;/td&gt;
      &lt;td&gt;26.912110&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;2010-01-13&lt;/td&gt;
      &lt;td&gt;207.870005&lt;/td&gt;
      &lt;td&gt;210.929995&lt;/td&gt;
      &lt;td&gt;204.099998&lt;/td&gt;
      &lt;td&gt;210.650002&lt;/td&gt;
      &lt;td&gt;151473000&lt;/td&gt;
      &lt;td&gt;27.291720&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2010-01-14&lt;/td&gt;
      &lt;td&gt;210.110003&lt;/td&gt;
      &lt;td&gt;210.459997&lt;/td&gt;
      &lt;td&gt;209.020004&lt;/td&gt;
      &lt;td&gt;209.430000&lt;/td&gt;
      &lt;td&gt;108223500&lt;/td&gt;
      &lt;td&gt;27.133657&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;2010-01-15&lt;/td&gt;
      &lt;td&gt;210.929995&lt;/td&gt;
      &lt;td&gt;211.599997&lt;/td&gt;
      &lt;td&gt;205.869999&lt;/td&gt;
      &lt;td&gt;205.930000&lt;/td&gt;
      &lt;td&gt;148516900&lt;/td&gt;
      &lt;td&gt;26.680198&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;filtrando-os-dados&quot;&gt;Filtrando os dados&lt;/h2&gt;

&lt;p&gt;O comando &lt;code class=&quot;highlighter-rouge&quot;&gt;filter&lt;/code&gt; é usado para filtrar dados. Existem várias formas de filtros. Primeiramente vamos ver o &lt;code class=&quot;highlighter-rouge&quot;&gt;modo SQL de filtro&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Filtrando dados da coluna &lt;code class=&quot;highlighter-rouge&quot;&gt;Close&lt;/code&gt; menores que &lt;code class=&quot;highlighter-rouge&quot;&gt;500&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Close &amp;lt; 500&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Open&lt;/th&gt;
      &lt;th&gt;High&lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
      &lt;th&gt;Volume&lt;/th&gt;
      &lt;th&gt;Adj Close&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2010-01-04&lt;/td&gt;
      &lt;td&gt;213.429998&lt;/td&gt;
      &lt;td&gt;214.499996&lt;/td&gt;
      &lt;td&gt;212.380001&lt;/td&gt;
      &lt;td&gt;214.009998&lt;/td&gt;
      &lt;td&gt;123432400&lt;/td&gt;
      &lt;td&gt;27.727039&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2010-01-05&lt;/td&gt;
      &lt;td&gt;214.599998&lt;/td&gt;
      &lt;td&gt;215.589994&lt;/td&gt;
      &lt;td&gt;213.249994&lt;/td&gt;
      &lt;td&gt;214.379993&lt;/td&gt;
      &lt;td&gt;150476200&lt;/td&gt;
      &lt;td&gt;27.774976&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2010-01-06&lt;/td&gt;
      &lt;td&gt;214.379993&lt;/td&gt;
      &lt;td&gt;215.230000&lt;/td&gt;
      &lt;td&gt;210.750004&lt;/td&gt;
      &lt;td&gt;210.969995&lt;/td&gt;
      &lt;td&gt;138040000&lt;/td&gt;
      &lt;td&gt;27.333178&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2010-01-07&lt;/td&gt;
      &lt;td&gt;211.750000&lt;/td&gt;
      &lt;td&gt;212.000006&lt;/td&gt;
      &lt;td&gt;209.050005&lt;/td&gt;
      &lt;td&gt;210.580000&lt;/td&gt;
      &lt;td&gt;119282800&lt;/td&gt;
      &lt;td&gt;27.282650&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2010-01-08&lt;/td&gt;
      &lt;td&gt;210.299994&lt;/td&gt;
      &lt;td&gt;212.000006&lt;/td&gt;
      &lt;td&gt;209.060005&lt;/td&gt;
      &lt;td&gt;211.980005&lt;/td&gt;
      &lt;td&gt;111902700&lt;/td&gt;
      &lt;td&gt;27.464034&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;95&lt;/th&gt;
      &lt;td&gt;2010-05-20&lt;/td&gt;
      &lt;td&gt;241.880009&lt;/td&gt;
      &lt;td&gt;243.849987&lt;/td&gt;
      &lt;td&gt;236.209999&lt;/td&gt;
      &lt;td&gt;237.759995&lt;/td&gt;
      &lt;td&gt;320728800&lt;/td&gt;
      &lt;td&gt;30.804078&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;96&lt;/th&gt;
      &lt;td&gt;2010-05-21&lt;/td&gt;
      &lt;td&gt;232.819988&lt;/td&gt;
      &lt;td&gt;244.499989&lt;/td&gt;
      &lt;td&gt;231.349995&lt;/td&gt;
      &lt;td&gt;242.319992&lt;/td&gt;
      &lt;td&gt;305972800&lt;/td&gt;
      &lt;td&gt;31.394869&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;97&lt;/th&gt;
      &lt;td&gt;2010-05-24&lt;/td&gt;
      &lt;td&gt;247.279999&lt;/td&gt;
      &lt;td&gt;250.900002&lt;/td&gt;
      &lt;td&gt;246.260002&lt;/td&gt;
      &lt;td&gt;246.759987&lt;/td&gt;
      &lt;td&gt;188559700&lt;/td&gt;
      &lt;td&gt;31.970113&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;98&lt;/th&gt;
      &lt;td&gt;2010-05-25&lt;/td&gt;
      &lt;td&gt;239.349991&lt;/td&gt;
      &lt;td&gt;246.759987&lt;/td&gt;
      &lt;td&gt;237.160007&lt;/td&gt;
      &lt;td&gt;245.220005&lt;/td&gt;
      &lt;td&gt;262001600&lt;/td&gt;
      &lt;td&gt;31.770594&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;99&lt;/th&gt;
      &lt;td&gt;2010-05-26&lt;/td&gt;
      &lt;td&gt;250.080009&lt;/td&gt;
      &lt;td&gt;252.129990&lt;/td&gt;
      &lt;td&gt;243.750011&lt;/td&gt;
      &lt;td&gt;244.109993&lt;/td&gt;
      &lt;td&gt;212663500&lt;/td&gt;
      &lt;td&gt;31.626781&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;100 rows × 7 columns&lt;/p&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Selecione as colunas &lt;code class=&quot;highlighter-rouge&quot;&gt;Open&lt;/code&gt; e &lt;code class=&quot;highlighter-rouge&quot;&gt;Close&lt;/code&gt; apenas quando os dados de &lt;code class=&quot;highlighter-rouge&quot;&gt;Close&lt;/code&gt; forem maiores que &lt;code class=&quot;highlighter-rouge&quot;&gt;200&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Open'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close &amp;gt; 200 '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Open&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;213.429998&lt;/td&gt;
      &lt;td&gt;214.009998&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;214.599998&lt;/td&gt;
      &lt;td&gt;214.379993&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;214.379993&lt;/td&gt;
      &lt;td&gt;210.969995&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;211.750000&lt;/td&gt;
      &lt;td&gt;210.580000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;210.299994&lt;/td&gt;
      &lt;td&gt;211.980005&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;144&lt;/th&gt;
      &lt;td&gt;252.360008&lt;/td&gt;
      &lt;td&gt;253.070011&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;145&lt;/th&gt;
      &lt;td&gt;252.839993&lt;/td&gt;
      &lt;td&gt;249.880005&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;146&lt;/th&gt;
      &lt;td&gt;249.390007&lt;/td&gt;
      &lt;td&gt;249.639999&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;147&lt;/th&gt;
      &lt;td&gt;251.790009&lt;/td&gt;
      &lt;td&gt;245.799992&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;148&lt;/th&gt;
      &lt;td&gt;242.669987&lt;/td&gt;
      &lt;td&gt;239.930000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;149 rows × 2 columns&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;Ao invés de usar a notação SQL. Podemos utilizar o &lt;code class=&quot;highlighter-rouge&quot;&gt;modo Python de Filtro&lt;/code&gt;&lt;br /&gt;
Nesse caso utilizaremos o objeto &lt;code class=&quot;highlighter-rouge&quot;&gt;pyspark.sql.column.Column&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pyspark.sql.column.Column
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O comando de &lt;code class=&quot;highlighter-rouge&quot;&gt;filtro&lt;/code&gt; é:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Open&lt;/th&gt;
      &lt;th&gt;High&lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
      &lt;th&gt;Volume&lt;/th&gt;
      &lt;th&gt;Adj Close&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2010-01-22&lt;/td&gt;
      &lt;td&gt;206.780006&lt;/td&gt;
      &lt;td&gt;207.499996&lt;/td&gt;
      &lt;td&gt;197.160000&lt;/td&gt;
      &lt;td&gt;197.750000&lt;/td&gt;
      &lt;td&gt;220441900&lt;/td&gt;
      &lt;td&gt;25.620401&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2010-01-28&lt;/td&gt;
      &lt;td&gt;204.930004&lt;/td&gt;
      &lt;td&gt;205.500004&lt;/td&gt;
      &lt;td&gt;198.699995&lt;/td&gt;
      &lt;td&gt;199.289995&lt;/td&gt;
      &lt;td&gt;293375600&lt;/td&gt;
      &lt;td&gt;25.819922&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2010-01-29&lt;/td&gt;
      &lt;td&gt;201.079996&lt;/td&gt;
      &lt;td&gt;202.199995&lt;/td&gt;
      &lt;td&gt;190.250002&lt;/td&gt;
      &lt;td&gt;192.060003&lt;/td&gt;
      &lt;td&gt;311488100&lt;/td&gt;
      &lt;td&gt;24.883208&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2010-02-01&lt;/td&gt;
      &lt;td&gt;192.369997&lt;/td&gt;
      &lt;td&gt;196.000000&lt;/td&gt;
      &lt;td&gt;191.299999&lt;/td&gt;
      &lt;td&gt;194.729998&lt;/td&gt;
      &lt;td&gt;187469100&lt;/td&gt;
      &lt;td&gt;25.229131&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2010-02-02&lt;/td&gt;
      &lt;td&gt;195.909998&lt;/td&gt;
      &lt;td&gt;196.319994&lt;/td&gt;
      &lt;td&gt;193.379993&lt;/td&gt;
      &lt;td&gt;195.859997&lt;/td&gt;
      &lt;td&gt;174585600&lt;/td&gt;
      &lt;td&gt;25.375533&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;2010-02-03&lt;/td&gt;
      &lt;td&gt;195.169994&lt;/td&gt;
      &lt;td&gt;200.200003&lt;/td&gt;
      &lt;td&gt;194.420004&lt;/td&gt;
      &lt;td&gt;199.229994&lt;/td&gt;
      &lt;td&gt;153832000&lt;/td&gt;
      &lt;td&gt;25.812149&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;2010-02-04&lt;/td&gt;
      &lt;td&gt;196.730003&lt;/td&gt;
      &lt;td&gt;198.370001&lt;/td&gt;
      &lt;td&gt;191.570005&lt;/td&gt;
      &lt;td&gt;192.050003&lt;/td&gt;
      &lt;td&gt;189413000&lt;/td&gt;
      &lt;td&gt;24.881912&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;2010-02-05&lt;/td&gt;
      &lt;td&gt;192.630003&lt;/td&gt;
      &lt;td&gt;196.000000&lt;/td&gt;
      &lt;td&gt;190.850002&lt;/td&gt;
      &lt;td&gt;195.460001&lt;/td&gt;
      &lt;td&gt;212576700&lt;/td&gt;
      &lt;td&gt;25.323710&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2010-02-08&lt;/td&gt;
      &lt;td&gt;195.690006&lt;/td&gt;
      &lt;td&gt;197.880003&lt;/td&gt;
      &lt;td&gt;193.999994&lt;/td&gt;
      &lt;td&gt;194.119997&lt;/td&gt;
      &lt;td&gt;119567700&lt;/td&gt;
      &lt;td&gt;25.150100&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;2010-02-09&lt;/td&gt;
      &lt;td&gt;196.419996&lt;/td&gt;
      &lt;td&gt;197.499994&lt;/td&gt;
      &lt;td&gt;194.749998&lt;/td&gt;
      &lt;td&gt;196.190004&lt;/td&gt;
      &lt;td&gt;158221700&lt;/td&gt;
      &lt;td&gt;25.418289&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;2010-02-10&lt;/td&gt;
      &lt;td&gt;195.889997&lt;/td&gt;
      &lt;td&gt;196.600000&lt;/td&gt;
      &lt;td&gt;194.260000&lt;/td&gt;
      &lt;td&gt;195.120007&lt;/td&gt;
      &lt;td&gt;92590400&lt;/td&gt;
      &lt;td&gt;25.279660&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;2010-02-11&lt;/td&gt;
      &lt;td&gt;194.880001&lt;/td&gt;
      &lt;td&gt;199.750006&lt;/td&gt;
      &lt;td&gt;194.059996&lt;/td&gt;
      &lt;td&gt;198.669994&lt;/td&gt;
      &lt;td&gt;137586400&lt;/td&gt;
      &lt;td&gt;25.739595&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;2010-02-23&lt;/td&gt;
      &lt;td&gt;199.999998&lt;/td&gt;
      &lt;td&gt;201.330002&lt;/td&gt;
      &lt;td&gt;195.709993&lt;/td&gt;
      &lt;td&gt;197.059998&lt;/td&gt;
      &lt;td&gt;143773700&lt;/td&gt;
      &lt;td&gt;25.531005&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Seleciona apenas a coluna &lt;code class=&quot;highlighter-rouge&quot;&gt;Volume&lt;/code&gt; quando a coluna &lt;code class=&quot;highlighter-rouge&quot;&gt;Low&lt;/code&gt; for menor que 192&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Volume'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Volume&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;311488100&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;187469100&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;189413000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;212576700&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;As vezes é necessário filtrar usando múltiplas condições.&lt;br /&gt;
Existem duas formas de fazer isso:&lt;br /&gt;&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Criando &lt;code class=&quot;highlighter-rouge&quot;&gt;filters&lt;/code&gt; em sequência.&lt;br /&gt;
 &lt;em&gt;Nesse caso não temos a ideia do OU condicional&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;192.060003&lt;/td&gt;
      &lt;td&gt;190.250002&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;194.729998&lt;/td&gt;
      &lt;td&gt;191.299999&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;192.050003&lt;/td&gt;
      &lt;td&gt;191.570005&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;195.460001&lt;/td&gt;
      &lt;td&gt;190.850002&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Concatenando multiplas condições&lt;br /&gt;
 Podemos utilizar diversos tipos de condicionais. Porém, duas observações são importantes:
    &lt;ol&gt;
      &lt;li&gt;Os simbolos de condicionais mudam:&lt;br /&gt;
 usar ‘&amp;amp;’ para ‘and’ &lt;br /&gt;
 usar ‘|’ para ‘or’&lt;br /&gt;
 usar ‘~’ para ‘not’&lt;br /&gt;&lt;/li&gt;
      &lt;li&gt;As expressões precisam ser separadas por parênteses.&lt;br /&gt;
 Errado: df[‘Low’] &amp;lt; 192 &amp;amp; df[‘Close’] &amp;lt; 200&lt;br /&gt;
 Certo: (df[‘Low’] &amp;lt; 192) &amp;amp; (df[‘Close’] &amp;lt; 200)&lt;br /&gt;&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;Selecione as colunas &lt;code class=&quot;highlighter-rouge&quot;&gt;Close&lt;/code&gt; e &lt;code class=&quot;highlighter-rouge&quot;&gt;Low&lt;/code&gt; quando &lt;strong&gt;Low&lt;/strong&gt; for menor que 192 e &lt;strong&gt;Close&lt;/strong&gt; menor que 200&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;192&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Close'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;192.060003&lt;/td&gt;
      &lt;td&gt;190.250002&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;194.729998&lt;/td&gt;
      &lt;td&gt;191.299999&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;192.050003&lt;/td&gt;
      &lt;td&gt;191.570005&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;195.460001&lt;/td&gt;
      &lt;td&gt;190.850002&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Selecione os dados quando a coluna &lt;code class=&quot;highlighter-rouge&quot;&gt;Low&lt;/code&gt; for &lt;code class=&quot;highlighter-rouge&quot;&gt;197.16&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;197.16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Open&lt;/th&gt;
      &lt;th&gt;High&lt;/th&gt;
      &lt;th&gt;Low&lt;/th&gt;
      &lt;th&gt;Close&lt;/th&gt;
      &lt;th&gt;Volume&lt;/th&gt;
      &lt;th&gt;Adj Close&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2010-01-22&lt;/td&gt;
      &lt;td&gt;206.780006&lt;/td&gt;
      &lt;td&gt;207.499996&lt;/td&gt;
      &lt;td&gt;197.16&lt;/td&gt;
      &lt;td&gt;197.75&lt;/td&gt;
      &lt;td&gt;220441900&lt;/td&gt;
      &lt;td&gt;25.620401&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;Vamos supor que você precise guardar essa informação de Linha em uma variável. Geralmente você deseja trabalhar com o objecto &lt;code class=&quot;highlighter-rouge&quot;&gt;Row&lt;/code&gt;.&lt;br /&gt;
Usa-se a função collect para isso.&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Collect (Ação) - Retorna todos os elementos do conjunto de dados como uma matriz. Isso geralmente é útil após um filtro ou outra operação que retorna um subconjunto suficientemente pequeno dos dados.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Low'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;197.16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[Row(Date=datetime.datetime(2010, 1, 22, 0, 0), Open=206.78000600000001, High=207.499996, Low=197.16, Close=197.75, Volume=220441900, Adj Close=25.620401)]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pode-se pegar os elementos diretamente com indices de list&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;206.78000600000001
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pode-se pegas os resultados como um dicionário&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{'Date': datetime.datetime(2010, 1, 22, 0, 0),
 'Open': 206.78000600000001,
 'High': 207.499996,
 'Low': 197.16,
 'Close': 197.75,
 'Volume': 220441900,
 'Adj Close': 25.620401}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'High'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;207.499996
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>adriano</name></author><category term="featured" /><summary type="html">Curso de Spark e Python Aula 04 - Operações Bàsicas</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://penseemti.com.br/wp-content/uploads/2017/02/A-importa%CC%82ncia-do-Banco-de-Dados.jpg" /></entry><entry><title type="html">Curso de Spark e Python: Aula 01 - Introdução</title><link href="http://www.adrianoavelar.com/spark/aula01_introducao.html" rel="alternate" type="text/html" title="Curso de Spark e Python: Aula 01 - Introdução" /><published>2019-06-23T00:00:00-03:00</published><updated>2019-06-23T00:00:00-03:00</updated><id>http://www.adrianoavelar.com/spark/aula01_Introducao</id><content type="html" xml:base="http://www.adrianoavelar.com/spark/aula01_introducao.html">&lt;h1 id=&quot;curso-de-spark-e-python&quot;&gt;Curso de Spark e Python&lt;/h1&gt;
&lt;h2 id=&quot;aula-01---introdução&quot;&gt;Aula 01 - Introdução&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;
Olá, seja bem vindo ao Curso de Spark e Python do Adriano Avelar. Caso encontre algum erro ou deseja entrar em contato, mande um e-mail para [eam.avelar@gmail.com]&lt;/p&gt;

&lt;p&gt;Nesse série de artigos, você irá aprender como usar o Spark com Python, incluindo Spark Streaming, Machine Learningg, Spark 2.0, Spark Sql e muito mais.&lt;/p&gt;

&lt;h4 id=&quot;habilidades-recomendadas&quot;&gt;Habilidades Recomendadas&lt;/h4&gt;
&lt;p&gt;Para que esse curso seja proveitoso para você, são necessárias as seguintes habilidades:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Básico de Programação (principalmente python)
Se você sabe criar um função, usar um loop while ou for, saber um poucos de listas. Já está valendo. Se não sabe nada dessas coisas sugiro procurar no youtube algum curso básico de Python.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Interesse em Big Data. 
Analisar grandes dados é diferente de analisar pequenos dados. E quando falo grande, digo na ordem de &lt;code class=&quot;highlighter-rouge&quot;&gt;terabytes&lt;/code&gt; ou vários &lt;code class=&quot;highlighter-rouge&quot;&gt;gigabytes&lt;/code&gt;. Se o seu interesse não é analisar grandes massas de dados, esse não é o curso ideal.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;o-que-não-vamos-ver&quot;&gt;O que não vamos ver&lt;/h4&gt;
&lt;p&gt;Como disse, esse curso é voltado para Big Data. Portanto, não iremos trabalhar com bibliotecas comuns do python, como &lt;code class=&quot;highlighter-rouge&quot;&gt;numpy&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;pandas&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;scikit-learn&lt;/code&gt; etc.
Essas bibliotecas não conseguem manipular uma grande massa de dados. Mesmo assim, iremos utilizar o &lt;code class=&quot;highlighter-rouge&quot;&gt;pandas&lt;/code&gt; e &lt;code class=&quot;highlighter-rouge&quot;&gt;matplotlib&lt;/code&gt; para melhorar a visualização de alguns resultados menores.&lt;/p&gt;

&lt;p&gt;Todo o curso será feito em &lt;code class=&quot;highlighter-rouge&quot;&gt;jupyter&lt;/code&gt;, mas você pode utilizar qualquer outra forma de programar o Spark.&lt;/p&gt;

&lt;h4 id=&quot;principais-topicos&quot;&gt;Principais Topicos&lt;/h4&gt;
&lt;p&gt;Veremos uma série de tópicos nesse curso, abaixo descrevo apenas os principais.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Conceitos de Spark&lt;/li&gt;
  &lt;li&gt;Spark Dataframes&lt;/li&gt;
  &lt;li&gt;Spark Sql&lt;/li&gt;
  &lt;li&gt;Introdução à Machine Learning em BigData&lt;/li&gt;
  &lt;li&gt;Regressão Linear&lt;/li&gt;
  &lt;li&gt;Regressão Logística&lt;/li&gt;
  &lt;li&gt;Àrvores de Decisão&lt;/li&gt;
  &lt;li&gt;Random Forest&lt;/li&gt;
  &lt;li&gt;Gradient Boost Machine&lt;/li&gt;
  &lt;li&gt;K-means Clustering&lt;/li&gt;
  &lt;li&gt;Processamento de Linguagem Natural (Natural Language Processing)&lt;/li&gt;
  &lt;li&gt;Spark Streaming&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Também veremos um pouco sobre pipeline e validação cruzada.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
Link da Próxima Aula:&lt;br /&gt;
&lt;a href=&quot;/spark/aula02_dataframe1.html&quot;&gt;Aula 02 &lt;/a&gt;&lt;/p&gt;</content><author><name>adriano</name></author><category term="featured" /><summary type="html">Curso de Spark e Python Aula 01 - Introdução Olá, seja bem vindo ao Curso de Spark e Python do Adriano Avelar. Caso encontre algum erro ou deseja entrar em contato, mande um e-mail para [eam.avelar@gmail.com]</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/proxy/0*o3JKcXgKhRaTl3hY.png" /></entry><entry><title type="html">Curso de Spark e Python: Aula 02 - DataFrame I</title><link href="http://www.adrianoavelar.com/spark/aula02_dataframe1.html" rel="alternate" type="text/html" title="Curso de Spark e Python: Aula 02 - DataFrame I" /><published>2019-06-23T00:00:00-03:00</published><updated>2019-06-23T00:00:00-03:00</updated><id>http://www.adrianoavelar.com/spark/aula02_dataframe</id><content type="html" xml:base="http://www.adrianoavelar.com/spark/aula02_dataframe1.html">&lt;h1 id=&quot;curso-de-spark-e-python&quot;&gt;Curso de Spark e Python&lt;/h1&gt;
&lt;h2 id=&quot;aula-02---dataframe-i&quot;&gt;Aula 02 - DataFrame I&lt;/h2&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;Para essa aula, você já deverá ter um ambiente &lt;code class=&quot;highlighter-rouge&quot;&gt;spark&lt;/code&gt; instalado e configurado. &lt;br /&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;O primeiro passo é iniciar uma sessão Spark. Mas antes, precisamos achar o spark que está instalado na máquina. &lt;br /&gt;
A biblioteca &lt;code class=&quot;highlighter-rouge&quot;&gt;findspark&lt;/code&gt; faz esse trabalho para nós. Caso não tenha ela instalado, você pode digitar no terminal:&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pip install findspark&lt;/code&gt; &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;ou no próprio jupyter: &lt;br /&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;findspark&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Requirement already satisfied: findspark in /home/adriano/anaconda3/lib/python3.7/site-packages (1.4.2)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;findspark&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;findspark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Soment após o &lt;code class=&quot;highlighter-rouge&quot;&gt;findspark.init()&lt;/code&gt; que o pacote pyspark estará disponivel para importação (comando a seguir)&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Agora, vamos criar uma sessão spark.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#appName: Nome da aplicação
#getOrCreate: Pega uma sessão se ela já existir, caso contrário criar uma nova 
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;HelloWorld&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Agora vamos importar alguns dados de um arquivo e criar um DataFrame Spark. Você pode utilizar o arquivo que desejar, no formato que desejar.&lt;br /&gt;
Vamos começar um simples Arquivo &lt;code class=&quot;highlighter-rouge&quot;&gt;json&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{&quot;name&quot;:&quot;Michael&quot;}
{&quot;name&quot;:&quot;Andy&quot;, &quot;age&quot;:30}
{&quot;name&quot;:&quot;Justin&quot;, &quot;age&quot;:19}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'uploads/data/people.json'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+
| age|   name|
+----+-------+
|null|Michael|
|  30|   Andy|
|  19| Justin|
+----+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Perceba que o Spark automaticamente substitui os valores faltosos como &lt;code class=&quot;highlighter-rouge&quot;&gt;null&lt;/code&gt;&lt;br /&gt;
Para imprimir o Schema do DataFrame utilize a função &lt;code class=&quot;highlighter-rouge&quot;&gt;printSchema&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root
 |-- age: long (nullable = true)
 |-- name: string (nullable = true)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O Spark também já inferiu os dados de acordo com o tipo que está sendo armazenado. &lt;br /&gt;
Outro comando útil é o &lt;code class=&quot;highlighter-rouge&quot;&gt;columns&lt;/code&gt;, que não é uma função e sim um parâmetro do &lt;code class=&quot;highlighter-rouge&quot;&gt;dataframe&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;['age', 'name']
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Para saber um resumo básico estatistico dos dados, podemos usar a função &lt;code class=&quot;highlighter-rouge&quot;&gt;describe&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DataFrame[summary: string, age: string, name: string]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Aqui vem um detalhe interessante. O Spark usa o princípio &lt;code class=&quot;highlighter-rouge&quot;&gt;Lazy Evaluation&lt;/code&gt;. Ou seja, ele não executa as transformações até que uma ação é chamada. &lt;br /&gt;
Nesse caso, describe é um transformação, portanto, não é executada até que uma ação seja solicitada. Essa estratégia permite acumular transformações e executar todas de uma única vez, o que traz um grande ganho de desempenho. &lt;br /&gt;&lt;br /&gt;
Para ver o resultado do &lt;code class=&quot;highlighter-rouge&quot;&gt;describe()&lt;/code&gt; use o comando &lt;code class=&quot;highlighter-rouge&quot;&gt;show()&lt;/code&gt;. Como show é uma ação, as transformações que vem antes serão executadas.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+-------+------------------+-------+
|summary|               age|   name|
+-------+------------------+-------+
|  count|                 2|      3|
|   mean|              24.5|   null|
| stddev|7.7781745930520225|   null|
|    min|                19|   Andy|
|    max|                30|Michael|
+-------+------------------+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Que tal ver os resultados através do Pandas?&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;toPandas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;summary&lt;/th&gt;
      &lt;th&gt;age&lt;/th&gt;
      &lt;th&gt;name&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;count&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;mean&lt;/td&gt;
      &lt;td&gt;24.5&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;stddev&lt;/td&gt;
      &lt;td&gt;7.7781745930520225&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;min&lt;/td&gt;
      &lt;td&gt;19&lt;/td&gt;
      &lt;td&gt;Andy&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;max&lt;/td&gt;
      &lt;td&gt;30&lt;/td&gt;
      &lt;td&gt;Michael&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;Muito melhor não é? &lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;⛔ Mas cuidado. O &lt;code class=&quot;highlighter-rouge&quot;&gt;pandas&lt;/code&gt; só pode ser utilizado quando os resultados são pequenos. Ele não foi feito para grandes massas de dados. Utilize com muita cautela. &lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Caso você não consiga rodar o comando acima, é possível que você não tenha o pandas em seu computador. O comando a seguir resolve isso.&lt;br /&gt;&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pandas&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Requirement already satisfied: pandas in /home/adriano/anaconda3/lib/python3.7/site-packages (1.0.1)
Requirement already satisfied: pytz&amp;gt;=2017.2 in /home/adriano/anaconda3/lib/python3.7/site-packages (from pandas) (2019.3)
Requirement already satisfied: numpy&amp;gt;=1.13.3 in /home/adriano/anaconda3/lib/python3.7/site-packages (from pandas) (1.18.1)
Requirement already satisfied: python-dateutil&amp;gt;=2.6.1 in /home/adriano/anaconda3/lib/python3.7/site-packages (from pandas) (2.8.1)
Requirement already satisfied: six&amp;gt;=1.5 in /home/adriano/anaconda3/lib/python3.7/site-packages (from python-dateutil&amp;gt;=2.6.1-&amp;gt;pandas) (1.14.0)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;criando-o-próprio-schema&quot;&gt;Criando o próprio Schema&lt;/h2&gt;

&lt;p&gt;Muitas vezes você necessita que seu dados estejam de tipos diferentes dos que o Spark inferiu. &lt;br /&gt;
Por exemplo, em nosso caso, ele inferiu que a coluna &lt;code class=&quot;highlighter-rouge&quot;&gt;age&lt;/code&gt; é do tipo &lt;strong&gt;long&lt;/strong&gt;, se quisermos mudar para &lt;strong&gt;int&lt;/strong&gt;, por exemplo, precisamos criar nosso proprio &lt;code class=&quot;highlighter-rouge&quot;&gt;Schema&lt;/code&gt;.&lt;br /&gt;
Então é isso que vamos fazer.&lt;br /&gt;
Primeiramente importamos nossos pacotes necessários.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Depois criamos uma lista com &lt;code class=&quot;highlighter-rouge&quot;&gt;StructFields&lt;/code&gt; informando 3 parâmetros em cada:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;1: Nome da coluna alvo.&lt;/li&gt;
  &lt;li&gt;2: Tipo de dados.&lt;/li&gt;
  &lt;li&gt;3: Se o campo pode ser nulo.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;data_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'age'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
              &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'name'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Agora, vamos carregar novamente os dados mas dessa vez passando o nosso schema criado.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'uploads/data/people.json'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_schema&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root
 |-- age: integer (nullable = true)
 |-- name: string (nullable = true)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;
Link da Próxima Aula:&lt;br /&gt;
&lt;a href=&quot;/spark/aula03_dataframe2.html&quot;&gt;Aula 03 &lt;/a&gt;&lt;/p&gt;</content><author><name>adriano</name></author><category term="featured" /><summary type="html">Curso de Spark e Python Aula 02 - DataFrame I Para essa aula, você já deverá ter um ambiente spark instalado e configurado.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://files.keepingcurrentmatters.com/wp-content/uploads/2020/05/05155523/20200506-KCM-Shar.jpg" /></entry><entry><title type="html">Primeiro Post</title><link href="http://www.adrianoavelar.com/myfirst-post/" rel="alternate" type="text/html" title="Primeiro Post" /><published>2019-01-18T00:00:00-03:00</published><updated>2019-01-18T00:00:00-03:00</updated><id>http://www.adrianoavelar.com/myfirst-post</id><content type="html" xml:base="http://www.adrianoavelar.com/myfirst-post/">&lt;p&gt;Olá. Me chamo Adriano Avelar, sou Engenheiro da Computação formado pela Universidade Federal do Pará. 
Tenho Doutorado em Computação pela Universidade Federal de Pernambuco. Já morei em Belém, Recife e agora estou em São Paulo.&lt;/p&gt;

&lt;p&gt;Já fui &lt;code class=&quot;highlighter-rouge&quot;&gt;Programador&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;Professor Universitário&lt;/code&gt; e já tive uma &lt;code class=&quot;highlighter-rouge&quot;&gt;escola de programação&lt;/code&gt; para crianças.&lt;/p&gt;

&lt;p&gt;Hoje trabalho como Cientista de Dados em um grande empresa.&lt;/p&gt;

&lt;h4 id=&quot;objetivo-do-blog&quot;&gt;Objetivo do Blog&lt;/h4&gt;

&lt;p&gt;O objetivo deste blog é passar o conhecimento que adquiri ao longo de minha jornado. Como professor sempre me preocupei muito em compartilhar o conhecimento. Espero que você goste do conteúdo e caso ache algum erro ou queira entrar em contato comigo, me envie um e-mail: &lt;code class=&quot;highlighter-rouge&quot;&gt;eam.avelar@gmail.com&lt;/code&gt;&lt;/p&gt;</content><author><name>adriano</name></author><category term="featured" /><summary type="html">Olá. Me chamo Adriano Avelar, sou Engenheiro da Computação formado pela Universidade Federal do Pará. Tenho Doutorado em Computação pela Universidade Federal de Pernambuco. Já morei em Belém, Recife e agora estou em São Paulo.</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://www.adrianoavelar.com/assets/images/demo1.jpg" /></entry></feed>